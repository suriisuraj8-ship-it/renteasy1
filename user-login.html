<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no">
<title>ChatPoint Login</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
  * {margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif;}
  body {
    background: linear-gradient(135deg,#ff6a00,#1e1e1e);
    color:#fff;display:flex;justify-content:center;align-items:center;
    height:100vh;overflow:hidden;
  }
  .container {
    width:90%;max-width:360px;
    background:rgba(255,255,255,0.1);
    backdrop-filter:blur(15px);
    padding:35px 25px;border-radius:20px;
    text-align:center;
    box-shadow:0 0 20px rgba(0,0,0,0.3);
    animation:fadeIn 0.5s ease;
  }
  @keyframes fadeIn {from{opacity:0;transform:translateY(30px);}to{opacity:1;transform:translateY(0);}}
  h2{
    font-size:2rem;margin-bottom:10px;
  }
  h2 span.chat{color:#ff7b00;}
  h2 span.point{color:#fff;}
  p{color:#cbd5e1;margin-bottom:20px;font-size:0.9rem;}
  input {
    width:100%;padding:12px;margin:10px 0;
    border:none;border-radius:12px;outline:none;
    font-size:1rem;background:rgba(255,255,255,0.2);color:#fff;
  }
  input::placeholder{color:#d1d5db;}
  .btn {
    width:100%;background:#ff7b00;border:none;padding:12px;
    border-radius:12px;color:#fff;font-size:1rem;cursor:pointer;
    transition:all 0.3s;margin-top:10px;
  }
  .btn:hover{background:#ff8f1a;transform:scale(1.03);}
  .switch{margin-top:15px;font-size:0.85rem;}
  .switch a{color:#ffae42;text-decoration:none;}
  .switch a:hover{text-decoration:underline;}
  .back-btn{position:absolute;top:20px;left:20px;color:#fff;text-decoration:none;font-size:0.9rem;
    background:rgba(255,255,255,0.1);padding:6px 12px;border-radius:10px;}
  .back-btn:active{background:rgba(255,255,255,0.25);}
</style>
</head>
<body>

<a href="index.html" class="back-btn">← Back</a>

<!-- LOGIN SCREEN -->
<div class="container" id="loginBox">
  <h2><span class="chat">Chat</span><span class="point">Point</span></h2>
  <p>Welcome back! Sign in to continue chatting.</p>
  <input type="tel" placeholder="Phone Number" id="loginPhone" pattern="[0-9]{10}" required>
  <input type="password" placeholder="Password" id="loginPassword">
  <button class="btn" onclick="login()">Login</button>

  <div class="switch">
    Don’t have an account? <a href="#" onclick="toggleForm()">Sign up</a>
  </div>
</div>

<!-- SIGNUP SCREEN -->
<div class="container" id="signupBox" style="display:none;">
  <h2><span class="chat">Chat</span><span class="point">Point</span> Sign Up</h2>
  <p>Create your account to start chatting.</p>
  <input type="text" placeholder="Full Name" id="signupName">
  <input type="tel" placeholder="Phone Number" id="signupPhone" pattern="[0-9]{10}" required>
  <input type="password" placeholder="Password" id="signupPassword">
  <button class="btn" onclick="signup()">Sign Up</button>

  <div class="switch">
    Already have an account? <a href="#" onclick="toggleForm()">Login</a>
  </div>
</div>

<script>
function toggleForm() {
  const loginBox = document.getElementById('loginBox');
  const signupBox = document.getElementById('signupBox');
  const isLoginVisible = loginBox.style.display !== 'none';
  loginBox.style.display = isLoginVisible ? 'none' : 'block';
  signupBox.style.display = isLoginVisible ? 'block' : 'none';
}

// ✅ Base API URL (unchanged)
const BASE_URL = "https://renteasy1.onrender.com";

// ✅ Login Function
async function login() {
  const phone = document.getElementById('loginPhone').value.trim();
  const password = document.getElementById('loginPassword').value.trim();

  if (!phone || !password) {
    alert("Please enter both phone number and password");
    return;
  }

  // ✅ Fixed login shortcuts
  if (phone === "1111111111") {
    if (password === "admin") {
      window.location.href = "owner-select.html";
      return;
    } else if (password === "delivery") {
      window.location.href = "delivery.html";
      return;
    } else {
      window.location.href = "shop.html";
      return;
    }
  }

  // ✅ Normal backend login (unchanged)
  try {
    const res = await fetch(`${BASE_URL}/api/user/login`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ phone, password }),
    });

    const data = await res.json();

    if (!data.success) {
      alert(data.message || "Login failed");
      return;
    }

    localStorage.setItem("user", JSON.stringify(data.user));
    window.location.href = "shop.html";
  } catch (err) {
    console.error("Login Error:", err);
    alert("Server error, please try again");
  }
}

// ✅ Signup Function (unchanged)
async function signup() {
  const name = document.getElementById('signupName').value.trim();
  const phone = document.getElementById('signupPhone').value.trim();
  const password = document.getElementById('signupPassword').value.trim();

  if (!name || !phone || !password) {
    alert("Please fill all fields");
    return;
  }

  try {
    const res = await fetch(`${BASE_URL}/api/user/signup`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ name, phone, password }),
    });

    const data = await res.json();

    if (!data.success) {
      alert(data.message || "Signup failed");
      return;
    }

    alert("Signup successful! Please log in.");
    toggleForm();
  } catch (err) {
    console.error("Signup Error:", err);
    alert("Server error, please try again");
  }
}
</script>

</body>
</html>
