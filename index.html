<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Chat Point | Food Shops</title>

  <!-- PWA ESSENTIALS -->
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icon-192.png" type="image/png">
  <meta name="theme-color" content="#ff6b35">

  <!-- FONTS & ICONS -->
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <style>
    :root{--bg:#0f0f1a;--card:rgba(20,25,45,.7);--text:#e0e7ff;--accent:#ff6b35;--glow:rgba(255,107,53,.3);--radius:18px}
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Outfit',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;display:flex;flex-direction:column;overflow-x:hidden}
    body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at 20% 80%,rgba(255,107,53,.12),transparent 50%),radial-gradient(circle at 80% 20%,rgba(100,200,255,.08),transparent 50%);z-index:-1}
    header{padding:16px 20px;background:rgba(15,20,40,.85);backdrop-filter:blur(12px);border-bottom:1px solid rgba(255,107,53,.2);display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:100}
    .brand{font-weight:800;font-size:26px}
    .brand .chat{background:linear-gradient(90deg,#ff6b35,#ff8a5b);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .nav-btn{font-size:24px;cursor:pointer;padding:10px;background:rgba(255,107,53,.15);border-radius:50%;transition:.3s}
    .nav-btn:hover{background:var(--accent);color:#000;transform:scale(1.1)}
    .sidebar{position:fixed;top:0;left:-100%;width:280px;height:100%;background:rgba(15,20,40,.95);padding:24px;backdrop-filter:blur(16px);transition:.4s;z-index:110;border-right:1px solid rgba(255,107,53,.2)}
    .sidebar.active{left:0}
    .sidebar a{display:block;padding:14px 16px;margin-bottom:8px;color:#ccc;text-decoration:none;font-weight:600;border-radius:12px;transition:.3s}
    .sidebar a:hover{background:rgba(255,107,53,.25);color:#fff;transform:translateX(6px)}
    .profile-section{padding:16px;background:rgba(255,107,53,.15);border-radius:14px;margin-bottom:20px;text-align:center;border:1px dashed rgba(255,107,53,.4)}
    .profile-section .name{font-weight:700;font-size:18px;color:#fff;margin-bottom:4px}
    .profile-section .phone{font-size:14px;color:#a8b8ff}
    .profile-section .login-prompt{font-size:15px;color:#ff8a5b}
    .profile-section .login-prompt a{color:#ff6b35;text-decoration:underline}
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;z-index:105;backdrop-filter:blur(8px)}
    .overlay.active{display:block}
    main{padding:20px;flex:1}
    .search-bar{max-width:500px;margin:0 auto 28px;display:flex;border-radius:50px;overflow:hidden;box-shadow:0 8px 25px rgba(0,0,0,.4);background:rgba(30,35,60,.7)}
    .search-bar input{flex:1;padding:16px 20px;border:none;background:transparent;color:#fff;font-size:16px;outline:none}
    .search-bar input::placeholder{color:#888}
    .search-bar button{padding:0 28px;background:var(--accent);border:none;color:#fff;font-weight:700;cursor:pointer;transition:.3s;font-size:15px}
    .search-bar button:hover{background:#ff8a5b;transform:scale(1.05);box-shadow:0 0 20px var(--glow)}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:22px}
    .card{background:var(--card);border-radius:var(--radius);overflow:hidden;cursor:pointer;transition:.5s;border:1px solid rgba(255,107,53,.2);backdrop-filter:blur(10px)}
    .card:hover{transform:translateY(-12px) scale(1.02);box-shadow:0 20px 40px rgba(0,0,0,.5),0 0 30px var(--glow)}
    .card img{width:100%;height:180px;object-fit:cover;transition:.5s}
    .card:hover img{transform:scale(1.08)}
    .info{padding:16px;display:flex;justify-content:space-between;align-items:center}
    .shop-name{font-weight:800;font-size:18px;color:var(--accent)}
    .rating{color:#34d399;font-weight:700;font-size:15px;display:flex;align-items:center;gap:5px}
    .desc{padding:0 16px 16px;font-size:14px;color:#a8b8ff;line-height:1.5}
    footer{text-align:center;padding:16px;background:rgba(15,20,40,.8);color:#666;font-size:14px;border-top:1px solid rgba(255,107,53,.2)}
    @media(max-width:768px){.grid{grid-template-columns:1fr 1fr}}
    @media(max-width:480px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>

  <header>
    <div class="nav-btn" id="navBtn"><i class="fas fa-bars"></i></div>
    <div class="brand"><span class="chat">Chat</span>Point</div>
  </header>

  <div class="sidebar" id="sidebar">
    <div class="profile-section" id="profileSection"></div>
    <a href="orders.html">My Orders</a>
    <a href="tel:8088975913">Contact: 8088975913</a>
    <a href="#" id="logout" style="display:none;color:#ff6b6b;">Logout</a>
  </div>
  <div class="overlay" id="overlay"></div>

  <main>
    <div class="search-bar">
      <input type="text" id="searchInput" placeholder="Search your favorite shop...">
      <button onclick="searchShops()">Search</button>
    </div>
    <div class="grid" id="grid"></div>
  </main>

  <footer>© 2025 Chat Point • Made with passion</footer>

  <!-- MAIN APP LOGIC -->
  <script>
    const shops = [
      { name: "7th Wonder (Cake)", img: "images/7th-wonder.png", rating: 4.8, desc: "Heavenly cakes & custom desserts.", items: ["Chocolate Cake","Red Velvet","Cupcakes","Birthday Special"] },
      { name: "Sangambar Udpi-Hotel", img: "images/sangambar-udpi-hotel.png", rating: 4.6, desc: "Pure vegetarian South Indian meals.", items: ["Masala Dosa","Idli Vada","Puri Bhaji","Filter Coffee"] },
      { name: "Nandini Grand Hotels", img: "images/nandini-grand-hotels.png", rating: 4.7, desc: "Crispy dosas with authentic flavors.", items: ["Plain Dosa","Ghee Roast","Onion Uttapam","Podi Idli"] },
      { name: "Pizza Point", img: "https://images.unsplash.com/photo-1513104890138-7c749659a591?w=500", rating: 4.5, desc: "Loaded pizzas with fresh toppings.", items: ["Margherita","Pepperoni","Veggie Supreme","BBQ Chicken"] },
      { name: "Fly Pizza", img: "https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?w=500", rating: 4.6, desc: "100% veg pizzas, light & tasty.", items: ["Paneer Tikka","Corn & Cheese","Farmhouse","Veg Extravaganza"] },
      { name: "Mister Chef", img: "https://images.unsplash.com/photo-1565299507177-b0ac66763828?w=500", rating: 4.7, desc: "Juicy burgers with secret sauce.", items: ["Classic Burger","Cheese Blast","Veg Crunch","Fries Combo"] },
      { name: "Bekary", img: "images/Bekary.png", rating: 4.5, desc: "Fresh sandwiches & healthy bites.", items: ["Veg Sandwich","Grilled Cheese","Club Sandwich","Cold Coffee"] },
      { name: "Dolphin", img: "images/dolphin.png", rating: 4.8, desc: "Tandoori, kebabs & non-veg specials.", items: ["Chicken Tandoori","Mutton Biryani","Fish Fry","Kebab Platter"] }
    ];

    function renderShops(filter=""){
      const grid=document.getElementById("grid");grid.innerHTML="";
      shops.filter(s=>s.name.toLowerCase().includes(filter.toLowerCase()))
        .forEach(shop=>{
          const card=document.createElement("div");card.className="card";
          card.onclick=()=>{localStorage.setItem("currentShop",JSON.stringify({name:shop.name,items:shop.items}));location.href=`items.html?shop=${encodeURIComponent(shop.name)}`;};
          card.innerHTML=`
            <img src="${shop.img}" alt="${shop.name}" onerror="this.src='https://via.placeholder.com/300x180?text=${encodeURIComponent(shop.name)}'">
            <div class="info"><div class="shop-name">${shop.name}</div><div class="rating"><i class="fas fa-star"></i> ${shop.rating}</div></div>
            <div class="desc">${shop.desc}</div>`;
          grid.appendChild(card);
        });
    }

    function searchShops(){renderShops(document.getElementById("searchInput").value.trim());}

    document.getElementById("navBtn").onclick=()=>{document.getElementById("sidebar").classList.add("active");document.getElementById("overlay").classList.add("active");};
    document.getElementById("overlay").onclick=()=>{document.getElementById("sidebar").classList.remove("active");document.getElementById("overlay").classList.remove("active");};

    function loadProfile(){
      const user=JSON.parse(localStorage.getItem("chatpoint_user")||"null");
      const profileEl=document.getElementById("profileSection");
      const logoutBtn=document.getElementById("logout");
      if(user && user._id){
        profileEl.innerHTML=`<i class="fas fa-user-circle" style="font-size:40px;color:#34d399;margin-bottom:8px;"></i><div class="name">${user.name||"User"}</div><div class="phone">${user.phone||"N/A"}</div>`;
        logoutBtn.style.display="block";
        logoutBtn.onclick=()=>{localStorage.removeItem("chatpoint_user");alert("Logged out!");location.reload();};
      }else{
        profileEl.innerHTML=`<div class="login-prompt"><i class="fas fa-user-circle" style="font-size:40px;color:#ff8a5b;"></i><br><a href="login.html">Login to see profile</a></div>`;
        logoutBtn.style.display="none";
      }
    }

    window.onload=()=>{renderShops();loadProfile();};
  </script>

  <!-- SERVICE WORKER ONLY (NO INSTALL BUTTON) -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then(reg => console.log('SW registered'))
          .catch(err => console.log('SW error:', err));
      });
    }
  </script>
</body>
</html>
